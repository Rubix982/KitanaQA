

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>doggmentator.trainer package &mdash; Doggmentator  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Doggmentator
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="doggmentator.html">doggmentator package</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Doggmentator</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>doggmentator.trainer package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/doggmentator-Copy1.trainer.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="doggmentator-trainer-package">
<h1>doggmentator.trainer package<a class="headerlink" href="#doggmentator-trainer-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-doggmentator.trainer.arguments">
<span id="doggmentator-trainer-arguments-module"></span><h2>doggmentator.trainer.arguments module<a class="headerlink" href="#module-doggmentator.trainer.arguments" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="doggmentator.trainer.arguments.ModelArguments">
<em class="property">class </em><code class="sig-prename descclassname">doggmentator.trainer.arguments.</code><code class="sig-name descname">ModelArguments</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_name_or_path</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">train_file_path</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">predict_file_path</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>str<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">model_type</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">aug_file_path</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tokenizer_name_or_path</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cache_dir</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">do_lower_case</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">version_2_with_negative</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">null_score_diff_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">n_best_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">20</span></em>, <em class="sig-param"><span class="n">verbose_logging</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">overwrite_cache</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">max_seq_length</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">512</span></em>, <em class="sig-param"><span class="n">max_query_length</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">64</span></em>, <em class="sig-param"><span class="n">max_answer_length</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">30</span></em>, <em class="sig-param"><span class="n">doc_stride</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">128</span></em>, <em class="sig-param"><span class="n">freeze_embeds</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">do_aug</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">do_alum</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">eta</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">alpha_final</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alpha_schedule</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eps</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">sigma</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">K</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">data_dir</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eval_all_checkpoints</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Arguments pertaining to which model/config/tokenizer we are going to fine-tune from.</p>
<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.K">
<code class="sig-name descname">K</code><em class="property">: Optional[float]</em><em class="property"> = 1</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.K" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.alpha">
<code class="sig-name descname">alpha</code><em class="property">: Optional[float]</em><em class="property"> = 1</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.alpha" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.alpha_final">
<code class="sig-name descname">alpha_final</code><em class="property">: Optional[float]</em><em class="property"> = None</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.alpha_final" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.alpha_schedule">
<code class="sig-name descname">alpha_schedule</code><em class="property">: Optional[str]</em><em class="property"> = None</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.alpha_schedule" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.aug_file_path">
<code class="sig-name descname">aug_file_path</code><em class="property">: str</em><em class="property"> = None</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.aug_file_path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.cache_dir">
<code class="sig-name descname">cache_dir</code><em class="property">: Optional[str]</em><em class="property"> = None</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.cache_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.data_dir">
<code class="sig-name descname">data_dir</code><em class="property">: Optional[str]</em><em class="property"> = None</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.data_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.do_alum">
<code class="sig-name descname">do_alum</code><em class="property">: bool</em><em class="property"> = True</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.do_alum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.do_aug">
<code class="sig-name descname">do_aug</code><em class="property">: bool</em><em class="property"> = True</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.do_aug" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.do_lower_case">
<code class="sig-name descname">do_lower_case</code><em class="property">: Optional[str]</em><em class="property"> = True</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.do_lower_case" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.doc_stride">
<code class="sig-name descname">doc_stride</code><em class="property">: Optional[int]</em><em class="property"> = 128</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.doc_stride" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.eps">
<code class="sig-name descname">eps</code><em class="property">: Optional[float]</em><em class="property"> = 1e-05</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.eps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.eta">
<code class="sig-name descname">eta</code><em class="property">: Optional[float]</em><em class="property"> = 0.001</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.eta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.eval_all_checkpoints">
<code class="sig-name descname">eval_all_checkpoints</code><em class="property">: Optional[str]</em><em class="property"> = False</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.eval_all_checkpoints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.freeze_embeds">
<code class="sig-name descname">freeze_embeds</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.freeze_embeds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.max_answer_length">
<code class="sig-name descname">max_answer_length</code><em class="property">: Optional[int]</em><em class="property"> = 30</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.max_answer_length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.max_query_length">
<code class="sig-name descname">max_query_length</code><em class="property">: Optional[int]</em><em class="property"> = 64</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.max_query_length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.max_seq_length">
<code class="sig-name descname">max_seq_length</code><em class="property">: Optional[int]</em><em class="property"> = 512</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.max_seq_length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.model_name_or_path">
<code class="sig-name descname">model_name_or_path</code><em class="property">: str</em><em class="property"> = None</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.model_name_or_path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.model_type">
<code class="sig-name descname">model_type</code><em class="property">: str</em><em class="property"> = None</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.model_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.n_best_size">
<code class="sig-name descname">n_best_size</code><em class="property">: int</em><em class="property"> = 20</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.n_best_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.null_score_diff_threshold">
<code class="sig-name descname">null_score_diff_threshold</code><em class="property">: float</em><em class="property"> = 0.0</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.null_score_diff_threshold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.overwrite_cache">
<code class="sig-name descname">overwrite_cache</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.overwrite_cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.predict_file_path">
<code class="sig-name descname">predict_file_path</code><em class="property">: Dict[str, str]</em><em class="property"> = None</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.predict_file_path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.sigma">
<code class="sig-name descname">sigma</code><em class="property">: Optional[float]</em><em class="property"> = 1e-05</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.sigma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.tokenizer_name_or_path">
<code class="sig-name descname">tokenizer_name_or_path</code><em class="property">: Optional[str]</em><em class="property"> = None</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.tokenizer_name_or_path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.train_file_path">
<code class="sig-name descname">train_file_path</code><em class="property">: str</em><em class="property"> = None</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.train_file_path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.verbose_logging">
<code class="sig-name descname">verbose_logging</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.verbose_logging" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="doggmentator.trainer.arguments.ModelArguments.version_2_with_negative">
<code class="sig-name descname">version_2_with_negative</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#doggmentator.trainer.arguments.ModelArguments.version_2_with_negative" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="doggmentator.trainer.arguments.default_logdir">
<code class="sig-prename descclassname">doggmentator.trainer.arguments.</code><code class="sig-name descname">default_logdir</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#doggmentator.trainer.arguments.default_logdir" title="Permalink to this definition">¶</a></dt>
<dd><p>Same default as PyTorch</p>
</dd></dl>

</div>
<div class="section" id="module-doggmentator.trainer.custom_schedulers">
<span id="doggmentator-trainer-custom-schedulers-module"></span><h2>doggmentator.trainer.custom_schedulers module<a class="headerlink" href="#module-doggmentator.trainer.custom_schedulers" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="doggmentator.trainer.custom_schedulers.custom_scheduler">
<code class="sig-prename descclassname">doggmentator.trainer.custom_schedulers.</code><code class="sig-name descname">custom_scheduler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">max_steps</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">update_fn</span><span class="p">:</span> <span class="n">Callable<span class="p">[</span>int<span class="p">, </span>float<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; float<a class="headerlink" href="#doggmentator.trainer.custom_schedulers.custom_scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a custom generator for an input param</p>
</dd></dl>

<dl class="py function">
<dt id="doggmentator.trainer.custom_schedulers.get_custom_exp">
<code class="sig-prename descclassname">doggmentator.trainer.custom_schedulers.</code><code class="sig-name descname">get_custom_exp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">max_steps</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">start_val</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">end_val</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span> &#x2192; Iterable<a class="headerlink" href="#doggmentator.trainer.custom_schedulers.get_custom_exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a custom exponential scheduler</p>
</dd></dl>

<dl class="py function">
<dt id="doggmentator.trainer.custom_schedulers.get_custom_linear">
<code class="sig-prename descclassname">doggmentator.trainer.custom_schedulers.</code><code class="sig-name descname">get_custom_linear</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">max_steps</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">start_val</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">end_val</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span> &#x2192; Iterable<a class="headerlink" href="#doggmentator.trainer.custom_schedulers.get_custom_linear" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a custom linear scheduler</p>
</dd></dl>

</div>
<div class="section" id="doggmentator-trainer-run-pipeline-module">
<h2>doggmentator.trainer.run_pipeline module<a class="headerlink" href="#doggmentator-trainer-run-pipeline-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-doggmentator.trainer.train">
<span id="doggmentator-trainer-train-module"></span><h2>doggmentator.trainer.train module<a class="headerlink" href="#module-doggmentator.trainer.train" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="doggmentator.trainer.train.Trainer">
<em class="property">class </em><code class="sig-prename descclassname">doggmentator.trainer.train.</code><code class="sig-name descname">Trainer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_args</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#doggmentator.trainer.train.Trainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">transformers.trainer.Trainer</span></code></p>
<p>A class to provide the adversarial and augmented training and evaluation
…</p>
<dl class="py attribute">
<dt id="doggmentator.trainer.train.Trainer.model_args">
<code class="sig-name descname">model_args</code><a class="headerlink" href="#doggmentator.trainer.train.Trainer.model_args" title="Permalink to this definition">¶</a></dt>
<dd><p>The arguments to tweak for training. Will default to a basic instance in arguments.py if not provided. For a list of the model_args, refer to arguments.py.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dataclass, ‘optional’ (?)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="doggmentator.trainer.train.Trainer.log">
<code class="sig-name descname">log</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">logs</span></em>, <em class="sig-param"><span class="n">iterator</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#doggmentator.trainer.train.Trainer.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Modified from HFTrainer base class, Log <code class="xref py py-obj docutils literal notranslate"><span class="pre">logs</span></code> on the various objects watching training.</p>
</dd></dl>

<dl class="py method">
<dt id="doggmentator.trainer.train.Trainer.training_step">
<code class="sig-name descname">training_step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">batch</span></em><span class="sig-paren">)</span><a class="headerlink" href="#doggmentator.trainer.train.Trainer.training_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs one step of training (might be adversarial and/or augmented) and returns the loss.</p>
</dd></dl>

<dl class="py method">
<dt id="doggmentator.trainer.train.Trainer.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prefix</span></em>, <em class="sig-param"><span class="n">args</span></em>, <em class="sig-param"><span class="n">tokenizer</span></em>, <em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">examples</span></em>, <em class="sig-param"><span class="n">features</span></em><span class="sig-paren">)</span><a class="headerlink" href="#doggmentator.trainer.train.Trainer.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the evaluation on the dataset and returns the evaluation metrics (Exact Match (EM) and F1-score).</p>
</dd></dl>

<dl class="py method">
<dt id="doggmentator.trainer.train.Trainer.adv_evaluate">
<code class="sig-name descname">adv_evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prefix</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">args</span></em>, <em class="sig-param"><span class="n">tokenizer</span></em>, <em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">examples</span></em>, <em class="sig-param"><span class="n">features</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="headerlink" href="#doggmentator.trainer.train.Trainer.adv_evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs PGD attack on each example in the evaluation dataset, recording aggregate metrics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> (<em>str</em>) – The model to be used for training</p></li>
<li><p><strong>args</strong> – </p></li>
<li><p><strong>tokenizer</strong> – The tokenizer used to preprocess the data.</p></li>
<li><p><strong>dataset</strong> (<em>List</em><em>(</em><em>torch.utils.data.TensorDataset</em><em>)</em>) – The evaluation dataset</p></li>
<li><p><strong>examples</strong> (<em>List</em><em>(</em><em>torch.utils.data.TensorDataset</em><em>)</em>) – The examples in the evaluation dataset</p></li>
<li><p><strong>features</strong> (<em>List</em><em>(</em><em>torch.utils.data.TensorDataset</em><em>)</em>) – SQuAD-like features corresponding to the evalaution dataset</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The evaluation metrics (Exact Match (EM) and F1-score)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id0">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prefix</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">args</span></em>, <em class="sig-param"><span class="n">tokenizer</span></em>, <em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">examples</span></em>, <em class="sig-param"><span class="n">features</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs evaluation on the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> (<em>str</em>) – The model to be used for training</p></li>
<li><p><strong>args</strong> – </p></li>
<li><p><strong>tokenizer</strong> – The tokenizer used to preprocess the data.</p></li>
<li><p><strong>dataset</strong> (<em>List</em><em>(</em><em>torch.utils.data.TensorDataset</em><em>)</em>) – The evaluation dataset</p></li>
<li><p><strong>examples</strong> (<em>List</em><em>(</em><em>torch.utils.data.TensorDataset</em><em>)</em>) – The examples in the evaluation dataset</p></li>
<li><p><strong>features</strong> (<em>List</em><em>(</em><em>torch.utils.data.TensorDataset</em><em>)</em>) – SQuAD-like features corresponding to the evalaution dataset</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The evaluation metrics (Exact Match (EM) and F1-score)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id1">
<code class="sig-name descname">log</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">logs</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>float<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">iterator</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>tqdm.std.tqdm<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd><p>Modified from HF Trainer base class</p>
<p>Log <code class="xref py py-obj docutils literal notranslate"><span class="pre">logs</span></code> on the various objects watching training.</p>
<p>Subclass and override this method to inject custom behavior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logs</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Dict[str,</span> <span class="pre">float]</span></code>) – The values to log.</p></li>
<li><p><strong>iterator</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">tqdm</span></code>, <cite>optional</cite>) – A potential tqdm progress bar to write the logs on.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="doggmentator.trainer.train.Trainer.setup_comet">
<code class="sig-name descname">setup_comet</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#doggmentator.trainer.train.Trainer.setup_comet" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup the optional Comet.ml integration.</p>
<dl class="simple">
<dt>Environment:</dt><dd><dl class="simple">
<dt>COMET_MODE:</dt><dd><p>(Optional): str - “OFFLINE”, “ONLINE”, or “DISABLED”</p>
</dd>
<dt>COMET_PROJECT_NAME:</dt><dd><p>(Optional): str - Comet.ml project name for experiments</p>
</dd>
<dt>COMET_OFFLINE_DIRECTORY:</dt><dd><p>(Optional): str - folder to use for saving offline experiments when <cite>COMET_MODE</cite> is “OFFLINE”</p>
</dd>
</dl>
</dd>
</dl>
<p>For a number of configurable items in the environment,
see <a class="reference external" href="https://www.comet.ml/docs/python-sdk/advanced/#comet-configuration-variables">here</a></p>
</dd></dl>

<dl class="py method">
<dt id="id2">
<code class="sig-name descname">training_step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">torch.nn.modules.module.Module</span></em>, <em class="sig-param"><span class="n">batch</span><span class="p">:</span> <span class="n">List</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="headerlink" href="#id2" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs one step of training (might be adversarial and/or augmented)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>nn.Module</em>) – The model to be used for training</p></li>
<li><p><strong>batch</strong> (<em>List</em>) – The btach used for one step of training. Includes the input_ids, attention_masks, token_type_ids, start_positions, and end_positions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The training loss after one step of training</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="doggmentator.trainer.train.tensor_to_list">
<code class="sig-prename descclassname">doggmentator.trainer.train.</code><code class="sig-name descname">tensor_to_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor</span></em><span class="sig-paren">)</span><a class="headerlink" href="#doggmentator.trainer.train.tensor_to_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a Tensor to List</p>
</dd></dl>

</div>
<div class="section" id="module-doggmentator.trainer.utils">
<span id="doggmentator-trainer-utils-module"></span><h2>doggmentator.trainer.utils module<a class="headerlink" href="#module-doggmentator.trainer.utils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="doggmentator.trainer.utils.build_flow">
<code class="sig-prename descclassname">doggmentator.trainer.utils.</code><code class="sig-name descname">build_flow</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">args</span></em>, <em class="sig-param"><span class="n">label</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'default'</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tokenizer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">train_dataset</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; prefect.core.flow.Flow<a class="headerlink" href="#doggmentator.trainer.utils.build_flow" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a Prefect flow composed of sequential modeling steps</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>Optional</em><em>(</em><em>str</em><em>)</em>) – The unique tag used to identify the Flow instance. The default value is ‘default’</p></li>
<li><p><strong>model</strong> (<em>Optional</em><em>(</em><em>transformers.PreTrainedModel</em><em>)</em>) – The pre-trained Transformer model. This parameter is required for training. The default value is None.</p></li>
<li><p><strong>tokenizer</strong> (<em>Optional</em><em>(</em><em>transformers.PreTrainedTokenizer</em><em>)</em>) – The tokenizer used to preprocess the data for the model.</p></li>
<li><p><strong>train_dataset</strong> (<em>torch.utils.data.TensorDataset</em>) – The training dataset. This parameter is required for training. The default value is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A prefect Flow object contained the specified steps and parameters</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Flow object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="doggmentator.trainer.utils.load_and_cache_examples">
<code class="sig-prename descclassname">doggmentator.trainer.utils.</code><code class="sig-name descname">load_and_cache_examples</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">args</span></em>, <em class="sig-param"><span class="n">tokenizer</span></em>, <em class="sig-param"><span class="n">evaluate</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">use_aug_path</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">output_examples</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; torch.utils.data.dataset.TensorDataset<a class="headerlink" href="#doggmentator.trainer.utils.load_and_cache_examples" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads SQuAD-like data features from dataset file (or cache)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<a class="reference internal" href="doggmentator.trainer.html#doggmentator.trainer.arguments.ModelArguments" title="doggmentator.trainer.arguments.ModelArguments"><em>doggmentator.trainer.arguments.ModelArguments</em></a>) – <p>A set of arguments related to the model. Specifically, the following arguments are used in this function:
- args.train_file_path : str</p>
<blockquote>
<div><p>Path to the training data file</p>
</div></blockquote>
<ul>
<li><dl class="simple">
<dt>args.do_aug<span class="classifier">bool</span></dt><dd><p>Flag to specify whether to use the augmented training set. If True, will be merged with the original training set specified in train_file_path. The default value is False.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>args.aug_file_path<span class="classifier">str</span></dt><dd><p>Path for augmented train dataset</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>args.data_dir<span class="classifier">str</span></dt><dd><p>Path for data files</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>args.model_name_or_path<span class="classifier">str</span></dt><dd><p>Path to pretrained model or model identifier from huggingface.co/models</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>args.max_seq_length<span class="classifier">Optional[int]</span></dt><dd><p>Max length for the input tokens, specified to the Transformer model defined in <cite>model_name_or_path</cite></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>args.overwrite_cache<span class="classifier">Bool</span></dt><dd><p>Overwrite cached data on load</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>args.predict_file_path<span class="classifier">Dict[str, str]</span></dt><dd><p>Paths for eval datasets, where the key is the data file tag, and the value is the data file path. Multiple file paths may be given for evaluation, and each will be cached and loaded separately.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>args.version_2_with_negative<span class="classifier">Bool</span></dt><dd><p>Flag that specifies to use the SQuAD v2.0 preprocessors. The default value is False.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>args.doc_stride<span class="classifier">Optional[int]</span></dt><dd><p>Corresponds to the doc_stride input param for some Huggingface Transformer models.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>args.max_query_length<span class="classifier">Optional[int]</span></dt><dd><p>Max length for the query segment in the Transformer model input.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>tokenizer</strong> – The Transformer model tokenizer used to preprocess the data.</p></li>
<li><p><strong>evaluate</strong> (<em>Optional</em><em>(</em><em>Bool</em><em>)</em>) – A flag to set the trainer task to either train or evaluate. The default value is False.</p></li>
<li><p><strong>use_aug_path</strong> (<em>Optional</em><em>(</em><em>Bool</em><em>)</em>) – A flag to define whether to use the aug_file_path or the train_file_path. If True, the augmented data path is used when loading and caching the data.</p></li>
<li><p><strong>output_examples</strong> (<em>Optional</em><em>(</em><em>Bool</em><em>)</em>) – A flag to define whether the examples and features should be returned by the data preprocessor. If False, the preprocessor only returns the dataset. This is necessary if the Trainer is used for evaluation or in a pipeline where training is followed by evaluation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The dataset containing the data to be used for training or evaluation.
Important Notes:
- If the output_examples is True, examples and features also are returned.
- If evaluate = True, the output will be a dictionary for which the keys are the name of the datasets used for evaluation and the values are the dataset (and optionally the examples and features).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>torch.utils.data.TensorDataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="doggmentator.trainer.utils.post_to_slack">
<code class="sig-prename descclassname">doggmentator.trainer.utils.</code><code class="sig-name descname">post_to_slack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">old_state</span></em>, <em class="sig-param"><span class="n">new_state</span></em><span class="sig-paren">)</span><a class="headerlink" href="#doggmentator.trainer.utils.post_to_slack" title="Permalink to this definition">¶</a></dt>
<dd><p>Post a msg to Slack url if configured, else simply return new_state object</p>
</dd></dl>

<dl class="py function">
<dt id="doggmentator.trainer.utils.set_seed">
<code class="sig-prename descclassname">doggmentator.trainer.utils.</code><code class="sig-name descname">set_seed</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">args</span></em><span class="sig-paren">)</span><a class="headerlink" href="#doggmentator.trainer.utils.set_seed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-doggmentator.trainer">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-doggmentator.trainer" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Aaron Sisto, Senzeyu Zhang, Mostafa Mirshekari, and Abijith Vijayendra

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>